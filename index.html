<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- PWA Ğ´Ğ»Ñ iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Trip Planner">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#1d1d1f">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="./manifest.json">
    
    <!-- Ğ˜ĞºĞ¾Ğ½ĞºĞ¸ Ğ´Ğ»Ñ iOS -->
    <link rel="apple-touch-icon" href="./icons/icon-180.png">
    <link rel="apple-touch-icon" sizes="152x152" href="./icons/icon-152.png">
    <link rel="apple-touch-icon" sizes="167x167" href="./icons/icon-167.png">
    <link rel="apple-touch-icon" sizes="180x180" href="./icons/icon-180.png">
    
    <title>Trip Planner</title>
    
    <style>
        /* === Ğ‘ĞĞ—ĞĞ’Ğ«Ğ• Ğ¡Ğ¢Ğ˜Ğ›Ğ˜ (Apple HIG inspired) === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        :root {
            --bg: #f2f2f7;
            --card: #ffffff;
            --text: #1d1d1f;
            --text-secondary: #8e8e93;
            --text-tertiary: #aeaeb2;
            --border: #e5e5ea;
            --accent: #007aff;
            --accent-light: #e3f2fd;
            --success: #34c759;
            --warning: #ff9500;
            --danger: #ff3b30;
            --safe-top: env(safe-area-inset-top);
            --safe-bottom: env(safe-area-inset-bottom);
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'Segoe UI', Roboto, sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            padding-top: var(--safe-top);
            padding-bottom: var(--safe-bottom);
            overflow-x: hidden;
        }
        
        /* === Ğ¢ĞĞĞšĞ˜Ğ™ Ğ¥Ğ•Ğ”Ğ•Ğ  === */
        .header {
            background: rgba(242, 242, 247, 0.85);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: 10px 16px;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 0.5px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            min-height: 44px;
        }
        
        .header-back {
            font-size: 17px;
            color: var(--accent);
            background: none;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 8px 0;
        }
        
        .header-back:active {
            opacity: 0.5;
        }
        
        .header-title {
            font-size: 17px;
            font-weight: 600;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .header-action {
            font-size: 17px;
            color: var(--accent);
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px 0;
        }
        
        .header-action:active {
            opacity: 0.5;
        }
        
        /* === ĞšĞĞĞ¢Ğ•ĞĞ¢ === */
        .content {
            padding: 16px;
            padding-bottom: 100px;
        }
        
        /* === Ğ¡Ğ•ĞšĞ¦Ğ˜Ğ¯ Ğ¡ Ğ—ĞĞ“ĞĞ›ĞĞ’ĞšĞĞœ === */
        .section-header {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 12px;
            padding-left: 4px;
        }
        
        .section-subheader {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin: 20px 0 8px 4px;
        }
        
        /* === ĞšĞĞ Ğ¢ĞĞ§ĞšĞ ĞŸĞĞ•Ğ—Ğ”ĞšĞ˜ === */
        .trip-card {
            background: var(--card);
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.04);
        }
        
        .trip-card-image {
            width: 100%;
            height: 140px;
            object-fit: cover;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
        }
        
        .trip-card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .trip-card-content {
            padding: 12px 14px;
        }
        
        .trip-card-title {
            font-size: 17px;
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .trip-card-dates {
            font-size: 14px;
            color: var(--text-secondary);
        }
        
        .trip-card-status {
            display: inline-block;
            font-size: 11px;
            font-weight: 600;
            padding: 3px 8px;
            border-radius: 10px;
            margin-top: 8px;
        }
        
        .trip-card-status.upcoming {
            background: var(--accent-light);
            color: var(--accent);
        }
        
        .trip-card-status.current {
            background: #e8f5e9;
            color: #34c759;
        }
        
        .trip-card-status.past {
            background: #f0f0f5;
            color: var(--text-secondary);
        }
        
        /* === Ğ¡ĞŸĞ˜Ğ¡ĞĞš === */
        .list {
            background: var(--card);
            border-radius: 12px;
            overflow: hidden;
        }
        
        .list-item {
            display: flex;
            align-items: center;
            padding: 12px 14px;
            border-bottom: 0.5px solid var(--border);
            cursor: pointer;
            transition: background 0.15s;
        }
        
        .list-item:last-child {
            border-bottom: none;
        }
        
        .list-item:active {
            background: var(--bg);
        }
        
        .list-item-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            margin-right: 12px;
            flex-shrink: 0;
        }
        
        .list-item-icon.map { background: #e8f5e9; }
        .list-item-icon.instagram { background: #fce4ec; }
        .list-item-icon.web { background: #e3f2fd; }
        .list-item-icon.event { background: #fff3e0; }
        .list-item-icon.note { background: #f3e5f5; }
        .list-item-icon.photo { background: #e0f7fa; }
        
        .list-item-content {
            flex: 1;
            min-width: 0;
        }
        
        .list-item-title {
            font-size: 16px;
            font-weight: 400;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .list-item-subtitle {
            font-size: 13px;
            color: var(--text-secondary);
            margin-top: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .list-item-arrow {
            color: var(--text-tertiary);
            font-size: 14px;
            margin-left: 8px;
        }
        
        .list-item-time {
            font-size: 14px;
            color: var(--text-secondary);
            margin-left: 8px;
            flex-shrink: 0;
        }
        
        /* === Ğ¡ĞĞ‘Ğ«Ğ¢Ğ˜Ğ• Ğ’ ĞšĞĞ›Ğ•ĞĞ”ĞĞ Ğ• === */
        .event-item {
            display: flex;
            align-items: flex-start;
            padding: 12px 14px;
            border-bottom: 0.5px solid var(--border);
        }
        
        .event-item:last-child {
            border-bottom: none;
        }
        
        .event-time {
            width: 50px;
            font-size: 14px;
            font-weight: 500;
            color: var(--accent);
            flex-shrink: 0;
        }
        
        .event-content {
            flex: 1;
        }
        
        .event-title {
            font-size: 16px;
            font-weight: 400;
        }
        
        .event-note {
            font-size: 13px;
            color: var(--text-secondary);
            margin-top: 2px;
        }
        
        /* === DAY HEADER === */
        .day-header {
            display: flex;
            align-items: center;
            padding: 12px 4px;
            margin-top: 16px;
        }
        
        .day-date {
            width: 44px;
            height: 44px;
            background: var(--accent);
            color: white;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
        }
        
        .day-date-num {
            font-size: 18px;
            font-weight: 700;
            line-height: 1;
        }
        
        .day-date-month {
            font-size: 10px;
            font-weight: 500;
            text-transform: uppercase;
        }
        
        .day-title {
            font-size: 17px;
            font-weight: 600;
        }
        
        .day-weekday {
            font-size: 13px;
            color: var(--text-secondary);
        }
        
        /* === FAB (Floating Action Button) === */
        .fab-container {
            position: fixed;
            bottom: calc(24px + var(--safe-bottom));
            right: 20px;
            z-index: 200;
        }
        
        .fab {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--accent);
            color: white;
            border: none;
            font-size: 28px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 122, 255, 0.4);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .fab:active {
            transform: scale(0.95);
        }
        
        .fab.open {
            transform: rotate(45deg);
        }
        
        .fab-menu {
            position: absolute;
            bottom: 70px;
            right: 0;
            display: flex;
            flex-direction: column;
            gap: 12px;
            opacity: 0;
            pointer-events: none;
            transform: translateY(20px);
            transition: all 0.3s ease;
        }
        
        .fab-menu.open {
            opacity: 1;
            pointer-events: auto;
            transform: translateY(0);
        }
        
        .fab-item {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 10px;
        }
        
        .fab-item-label {
            background: var(--card);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            white-space: nowrap;
        }
        
        .fab-item-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: var(--card);
            border: none;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.12);
        }
        
        .fab-item-btn:active {
            transform: scale(0.95);
        }
        
        /* === ĞœĞĞ”ĞĞ›Ğ¬ĞĞ«Ğ• ĞĞšĞĞ === */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.4);
            display: none;
            align-items: flex-end;
            justify-content: center;
            z-index: 1000;
        }
        
        .modal-overlay.active {
            display: flex;
        }
        
        .modal {
            background: var(--card);
            border-radius: 14px 14px 0 0;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
        }
        
        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }
        
        .modal-handle {
            width: 36px;
            height: 5px;
            background: var(--border);
            border-radius: 3px;
            margin: 8px auto;
        }
        
        .modal-header {
            padding: 12px 16px;
            border-bottom: 0.5px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 17px;
            font-weight: 600;
        }
        
        .modal-close {
            font-size: 17px;
            color: var(--accent);
            background: none;
            border: none;
            cursor: pointer;
        }
        
        .modal-body {
            padding: 16px;
            padding-bottom: calc(16px + var(--safe-bottom));
        }
        
        /* === Ğ¤ĞĞ ĞœĞ« === */
        .form-group {
            margin-bottom: 16px;
        }
        
        .form-label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 6px;
            padding-left: 4px;
        }
        
        .input {
            width: 100%;
            padding: 12px 14px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            background: var(--bg);
            color: var(--text);
        }
        
        .input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.2);
        }
        
        .input::placeholder {
            color: var(--text-tertiary);
        }
        
        textarea.input {
            resize: vertical;
            min-height: 80px;
        }
        
        /* === ĞšĞĞĞŸĞšĞ˜ === */
        .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 14px 20px;
            border: none;
            border-radius: 12px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.15s;
            width: 100%;
        }
        
        .btn-primary {
            background: var(--accent);
            color: white;
        }
        
        .btn-primary:active {
            opacity: 0.8;
        }
        
        .btn-secondary {
            background: var(--bg);
            color: var(--text);
        }
        
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        
        .btn-text {
            background: none;
            color: var(--accent);
            padding: 8px;
        }
        
        /* === Ğ¡Ğ•Ğ“ĞœĞ•ĞĞ¢ĞĞ«Ğ™ ĞšĞĞĞ¢Ğ ĞĞ›Ğ¬ === */
        .segment-control {
            display: flex;
            background: var(--bg);
            border-radius: 10px;
            padding: 2px;
            margin-bottom: 16px;
        }
        
        .segment-btn {
            flex: 1;
            padding: 8px 12px;
            border: none;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 500;
            background: transparent;
            color: var(--text);
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .segment-btn.active {
            background: var(--card);
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        }
        
        /* === ĞŸĞ£Ğ¡Ğ¢ĞĞ• Ğ¡ĞĞ¡Ğ¢ĞĞ¯ĞĞ˜Ğ• === */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
        }
        
        .empty-icon {
            font-size: 56px;
            margin-bottom: 16px;
        }
        
        .empty-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .empty-text {
            font-size: 15px;
            color: var(--text-secondary);
            line-height: 1.4;
        }
        
        /* === Ğ¤ĞĞ¢Ğ Ğ“ĞĞ›Ğ•Ğ Ğ•Ğ¯ === */
        .photo-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2px;
            margin-top: 12px;
        }
        
        .photo-item {
            aspect-ratio: 1;
            background: var(--bg);
            overflow: hidden;
            cursor: pointer;
        }
        
        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .photo-add {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: var(--text-tertiary);
            border: 2px dashed var(--border);
        }
        
        /* === Ğ¡Ğ¡Ğ«Ğ›ĞšĞ ĞŸĞ Ğ•Ğ’Ğ¬Ğ® === */
        .link-preview {
            background: var(--card);
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 12px;
        }
        
        .link-preview-content {
            padding: 12px 14px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .link-favicon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            background: var(--bg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            flex-shrink: 0;
        }
        
        .link-info {
            flex: 1;
            min-width: 0;
        }
        
        .link-title {
            font-size: 15px;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .link-url {
            font-size: 12px;
            color: var(--text-secondary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* === Ğ£Ğ’Ğ•Ğ”ĞĞœĞ›Ğ•ĞĞ˜Ğ¯ === */
        .toast {
            position: fixed;
            top: calc(60px + var(--safe-top));
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            background: var(--text);
            color: white;
            padding: 12px 20px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 500;
            z-index: 2000;
            transition: transform 0.3s ease;
        }
        
        .toast.show {
            transform: translateX(-50%) translateY(0);
        }
        
        .toast.success { background: var(--success); }
        .toast.error { background: var(--danger); }
        
        /* === Ğ£Ğ¢Ğ˜Ğ›Ğ˜Ğ¢Ğ« === */
        .hidden { display: none !important; }
        .mb-8 { margin-bottom: 8px; }
        .mb-16 { margin-bottom: 16px; }
        .text-center { text-align: center; }
        .text-secondary { color: var(--text-secondary); }
        
        /* === ĞĞŸĞ˜Ğ¡ĞĞĞ˜Ğ• === */
        .description-block {
            background: var(--card);
            border-radius: 12px;
            padding: 14px;
            margin-bottom: 12px;
        }
        
        .description-text {
            font-size: 15px;
            line-height: 1.5;
            color: var(--text);
            white-space: pre-wrap;
        }
        
        /* === TAB BAR Ğ”Ğ›Ğ¯ Ğ”Ğ•Ğ¢ĞĞ›Ğ•Ğ™ ĞŸĞĞ•Ğ—Ğ”ĞšĞ˜ === */
        .tab-bar {
            display: flex;
            background: var(--card);
            border-bottom: 0.5px solid var(--border);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .tab-bar::-webkit-scrollbar {
            display: none;
        }
        
        .tab-item {
            flex-shrink: 0;
            padding: 12px 16px;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
            border: none;
            background: none;
            cursor: pointer;
            position: relative;
        }
        
        .tab-item.active {
            color: var(--accent);
        }
        
        .tab-item.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 16px;
            right: 16px;
            height: 2px;
            background: var(--accent);
            border-radius: 1px;
        }
        
        /* === COVER IMAGE PICKER === */
        .cover-picker {
            width: 100%;
            height: 180px;
            border-radius: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            overflow: hidden;
            margin-bottom: 16px;
            position: relative;
        }
        
        .cover-picker img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .cover-picker-text {
            color: white;
            font-size: 15px;
            font-weight: 500;
        }
        
        .cover-picker-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }
        
        .cover-picker-overlay {
            position: absolute;
            inset: 0;
            background: rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .cover-picker:hover .cover-picker-overlay,
        .cover-picker:active .cover-picker-overlay {
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- Ğ¥ĞµĞ´ĞµÑ€ -->
    <header class="header" id="header">
        <button class="header-back hidden" id="headerBack" onclick="App.goBack()">
            â€¹ ĞĞ°Ğ·Ğ°Ğ´
        </button>
        <span class="header-title" id="headerTitle">ĞŸĞ¾ĞµĞ·Ğ´ĞºĞ¸</span>
        <button class="header-action hidden" id="headerAction"></button>
    </header>
    
    <!-- ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚ -->
    <main class="content" id="mainContent">
        <!-- ĞšĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ Ğ´Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¸ -->
    </main>
    
    <!-- FAB Ñ Ğ¼ĞµĞ½Ñ -->
    <div class="fab-container" id="fabContainer">
        <div class="fab-menu" id="fabMenu">
            <!-- FAB Ğ¼ĞµĞ½Ñ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ Ğ´Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¸ -->
        </div>
        <button class="fab" id="fabBtn" onclick="App.toggleFab()">+</button>
    </div>
    
    <!-- ĞœĞ¾Ğ´Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¾ĞºĞ½Ğ¾ -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal" id="modalContent">
            <div class="modal-handle"></div>
            <!-- ĞšĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚ Ğ¼Ğ¾Ğ´Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¾ĞºĞ½Ğ° -->
        </div>
    </div>
    
    <!-- Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ -->
    <div class="toast" id="toast"></div>

<script>
// â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
// â•‘                         TRIP PLANNER - Ğ¯Ğ”Ğ Ğ                                â•‘
// â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

class TripPlannerApp {
    constructor() {
        this.db = null;
        this.currentView = 'trips'; // trips | tripDetail | addTrip
        this.currentTrip = null;
        this.currentTab = 'schedule'; // schedule | links | notes | photos
        this.fabOpen = false;
        
        this.dom = {
            content: document.getElementById('mainContent'),
            header: document.getElementById('header'),
            headerBack: document.getElementById('headerBack'),
            headerTitle: document.getElementById('headerTitle'),
            headerAction: document.getElementById('headerAction'),
            fabContainer: document.getElementById('fabContainer'),
            fabBtn: document.getElementById('fabBtn'),
            fabMenu: document.getElementById('fabMenu'),
            modal: document.getElementById('modalOverlay'),
            modalContent: document.getElementById('modalContent'),
            toast: document.getElementById('toast')
        };
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Ğ˜ĞĞ˜Ğ¦Ğ˜ĞĞ›Ğ˜Ğ—ĞĞ¦Ğ˜Ğ¯
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    async init() {
        console.log('ğŸ§³ Trip Planner: Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ...');
        
        await this.initDatabase();
        this.renderTrips();
        this.registerServiceWorker();
        
        // Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ Ğ¼Ğ¾Ğ´Ğ°Ğ»ĞºĞ¸ Ğ¿Ğ¾ ĞºĞ»Ğ¸ĞºÑƒ Ğ½Ğ° Ğ¾Ğ²ĞµÑ€Ğ»ĞµĞ¹
        this.dom.modal.onclick = (e) => {
            if (e.target === this.dom.modal) this.closeModal();
        };
        
        // Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ FAB Ğ¿Ğ¾ ĞºĞ»Ğ¸ĞºÑƒ Ğ²Ğ½Ğµ
        document.addEventListener('click', (e) => {
            if (this.fabOpen && !this.dom.fabContainer.contains(e.target)) {
                this.closeFab();
            }
        });
        
        console.log('âœ… Trip Planner Ğ³Ğ¾Ñ‚Ğ¾Ğ²!');
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Ğ‘ĞĞ—Ğ Ğ”ĞĞĞĞ«Ğ¥
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    async initDatabase() {
        return new Promise((resolve, reject) => {
            const request = indexedDB.open('TripPlannerDB', 1);
            
            request.onerror = () => reject(request.error);
            
            request.onsuccess = () => {
                this.db = request.result;
                console.log('âœ… Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ°');
                resolve();
            };
            
            request.onupgradeneeded = (event) => {
                const db = event.target.result;
                
                // ĞŸĞ¾ĞµĞ·Ğ´ĞºĞ¸
                if (!db.objectStoreNames.contains('trips')) {
                    const store = db.createObjectStore('trips', { keyPath: 'id' });
                    store.createIndex('startDate', 'startDate', { unique: false });
                }
                
                // Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ (Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ)
                if (!db.objectStoreNames.contains('events')) {
                    const store = db.createObjectStore('events', { keyPath: 'id' });
                    store.createIndex('tripId', 'tripId', { unique: false });
                    store.createIndex('date', 'date', { unique: false });
                }
                
                // Ğ¡ÑÑ‹Ğ»ĞºĞ¸
                if (!db.objectStoreNames.contains('links')) {
                    const store = db.createObjectStore('links', { keyPath: 'id' });
                    store.createIndex('tripId', 'tripId', { unique: false });
                }
                
                // Ğ—Ğ°Ğ¼ĞµÑ‚ĞºĞ¸
                if (!db.objectStoreNames.contains('notes')) {
                    const store = db.createObjectStore('notes', { keyPath: 'id' });
                    store.createIndex('tripId', 'tripId', { unique: false });
                }
                
                // Ğ¤Ğ¾Ñ‚Ğ¾ (base64)
                if (!db.objectStoreNames.contains('photos')) {
                    const store = db.createObjectStore('photos', { keyPath: 'id' });
                    store.createIndex('tripId', 'tripId', { unique: false });
                }
            };
        });
    }
    
    async dbSave(store, data) {
        return new Promise((resolve, reject) => {
            const tx = this.db.transaction(store, 'readwrite');
            const s = tx.objectStore(store);
            const req = s.put(data);
            req.onsuccess = () => resolve(req.result);
            req.onerror = () => reject(req.error);
        });
    }
    
    async dbGet(store, id) {
        return new Promise((resolve, reject) => {
            const tx = this.db.transaction(store, 'readonly');
            const s = tx.objectStore(store);
            const req = s.get(id);
            req.onsuccess = () => resolve(req.result);
            req.onerror = () => reject(req.error);
        });
    }
    
    async dbGetAll(store, indexName = null, query = null) {
        return new Promise((resolve, reject) => {
            const tx = this.db.transaction(store, 'readonly');
            const s = tx.objectStore(store);
            const target = indexName ? s.index(indexName) : s;
            const req = query !== null ? target.getAll(query) : target.getAll();
            req.onsuccess = () => resolve(req.result || []);
            req.onerror = () => reject(req.error);
        });
    }
    
    async dbDelete(store, id) {
        return new Promise((resolve, reject) => {
            const tx = this.db.transaction(store, 'readwrite');
            const s = tx.objectStore(store);
            const req = s.delete(id);
            req.onsuccess = () => resolve();
            req.onerror = () => reject(req.error);
        });
    }
    
    async dbClear(store) {
        return new Promise((resolve, reject) => {
            const tx = this.db.transaction(store, 'readwrite');
            const s = tx.objectStore(store);
            const req = s.clear();
            req.onsuccess = () => resolve();
            req.onerror = () => reject(req.error);
        });
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ĞĞĞ’Ğ˜Ğ“ĞĞ¦Ğ˜Ğ¯
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    goBack() {
        if (this.currentView === 'tripDetail') {
            this.renderTrips();
        }
    }
    
    updateHeader(title, showBack = false, actionBtn = null) {
        this.dom.headerTitle.textContent = title;
        this.dom.headerBack.classList.toggle('hidden', !showBack);
        
        if (actionBtn) {
            this.dom.headerAction.textContent = actionBtn.text;
            this.dom.headerAction.onclick = actionBtn.onClick;
            this.dom.headerAction.classList.remove('hidden');
        } else {
            this.dom.headerAction.classList.add('hidden');
        }
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // FAB ĞœĞ•ĞĞ®
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    toggleFab() {
        this.fabOpen ? this.closeFab() : this.openFab();
    }
    
    openFab() {
        this.fabOpen = true;
        this.dom.fabBtn.classList.add('open');
        this.dom.fabMenu.classList.add('open');
    }
    
    closeFab() {
        this.fabOpen = false;
        this.dom.fabBtn.classList.remove('open');
        this.dom.fabMenu.classList.remove('open');
    }
    
    updateFabMenu(items) {
        this.dom.fabMenu.innerHTML = items.map(item => `
            <div class="fab-item">
                <span class="fab-item-label">${item.label}</span>
                <button class="fab-item-btn" onclick="App.closeFab(); ${item.action}">${item.icon}</button>
            </div>
        `).join('');
    }
    
    hideFab() {
        this.dom.fabContainer.classList.add('hidden');
    }
    
    showFab() {
        this.dom.fabContainer.classList.remove('hidden');
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Ğ¡ĞŸĞ˜Ğ¡ĞĞš ĞŸĞĞ•Ğ—Ğ”ĞĞš
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    async renderTrips() {
        this.currentView = 'trips';
        this.currentTrip = null;
        this.updateHeader('ĞŸĞ¾ĞµĞ·Ğ´ĞºĞ¸');
        
        this.updateFabMenu([
            { label: 'ĞĞ¾Ğ²Ğ°Ñ Ğ¿Ğ¾ĞµĞ·Ğ´ĞºĞ°', icon: 'âœˆï¸', action: 'App.showAddTripModal()' },
            { label: 'Ğ˜Ğ¼Ğ¿Ğ¾Ñ€Ñ‚ JSON', icon: 'ğŸ“¥', action: 'App.importData()' },
            { label: 'Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ²ÑĞµĞ³Ğ¾', icon: 'ğŸ“¤', action: 'App.exportAllData()' }
        ]);
        this.showFab();
        
        const trips = await this.dbGetAll('trips');
        
        if (trips.length === 0) {
            this.dom.content.innerHTML = `
                <div class="empty-state">
                    <div class="empty-icon">ğŸ§³</div>
                    <div class="empty-title">ĞĞµÑ‚ Ğ¿Ğ¾ĞµĞ·Ğ´Ğ¾Ğº</div>
                    <div class="empty-text">ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ + Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ ÑĞ¿Ğ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿ĞµÑ€Ğ²Ğ¾Ğµ Ğ¿ÑƒÑ‚ĞµÑˆĞµÑÑ‚Ğ²Ğ¸Ğµ</div>
                </div>
            `;
            return;
        }
        
        // Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°: ÑĞµĞ¹Ñ‡Ğ°Ñ, Ğ±ÑƒĞ´ÑƒÑ‰Ğ¸Ğµ, Ğ¿Ñ€Ğ¾ÑˆĞ»Ñ‹Ğµ
        const today = new Date().toISOString().split('T')[0];
        
        // Ğ¡ĞµĞ¹Ñ‡Ğ°Ñ: startDate <= ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ Ğ˜ endDate >= ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ
        const current = trips.filter(t => t.startDate <= today && t.endDate >= today)
            .sort((a, b) => a.endDate.localeCompare(b.endDate));
        
        // ĞŸÑ€ĞµĞ´ÑÑ‚Ğ¾ÑÑ‰Ğ¸Ğµ: startDate > ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ
        const upcoming = trips.filter(t => t.startDate > today)
            .sort((a, b) => a.startDate.localeCompare(b.startDate));
        
        // ĞŸÑ€Ğ¾ÑˆĞ»Ñ‹Ğµ: endDate < ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ
        const past = trips.filter(t => t.endDate < today)
            .sort((a, b) => b.startDate.localeCompare(a.startDate));
        
        let html = '';
        
        if (current.length > 0) {
            html += `<div class="section-subheader">âœˆï¸ Ğ¡ĞµĞ¹Ñ‡Ğ°Ñ</div>`;
            html += current.map(t => this.renderTripCard(t, 'current')).join('');
        }
        
        if (upcoming.length > 0) {
            html += `<div class="section-subheader">ĞŸÑ€ĞµĞ´ÑÑ‚Ğ¾ÑÑ‰Ğ¸Ğµ</div>`;
            html += upcoming.map(t => this.renderTripCard(t, 'upcoming')).join('');
        }
        
        if (past.length > 0) {
            html += `<div class="section-subheader">ĞŸÑ€Ğ¾ÑˆĞ»Ñ‹Ğµ</div>`;
            html += past.map(t => this.renderTripCard(t, 'past')).join('');
        }
        
        this.dom.content.innerHTML = html;
    }
    
    renderTripCard(trip, status) {
        const dates = this.formatDateRange(trip.startDate, trip.endDate);
        const statusLabels = { 
            current: 'Ğ’ Ğ¿Ğ¾ĞµĞ·Ğ´ĞºĞµ', 
            upcoming: 'Ğ¡ĞºĞ¾Ñ€Ğ¾', 
            past: 'Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ°' 
        };
        const statusLabel = statusLabels[status];
        
        // Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµĞ¼ ĞºÑ€Ğ°ÑĞ¸Ğ²Ñ‹Ğ¹ Ğ³Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚ Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ñ
        const gradients = [
            'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
            'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
            'linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)',
            'linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)',
            'linear-gradient(135deg, #fa709a 0%, #fee140 100%)',
            'linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)',
            'linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%)',
            'linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%)',
        ];
        const gradientIndex = trip.title.length % gradients.length;
        const gradient = gradients[gradientIndex];
        const emoji = this.getTripEmoji(trip.title);
        
        const coverHtml = trip.cover 
            ? `<div class="trip-card-image" style="background-image: url('${trip.cover}'); background-size: cover; background-position: center;"></div>`
            : `<div class="trip-card-image" style="background: ${gradient};">
                   <span style="font-size: 56px; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));">${emoji}</span>
               </div>`;
        
        return `
            <div class="trip-card" onclick="App.openTrip('${trip.id}')">
                ${coverHtml}
                <div class="trip-card-content">
                    <div class="trip-card-title">${trip.title}</div>
                    <div class="trip-card-dates">${dates}</div>
                    <span class="trip-card-status ${status}">${statusLabel}</span>
                </div>
            </div>
        `;
    }
    
    getTripEmoji(title) {
        const lower = title.toLowerCase();
        if (lower.includes('Ğ¿Ğ»ÑĞ¶') || lower.includes('Ğ¼Ğ¾Ñ€Ğµ') || lower.includes('ocean')) return 'ğŸ–ï¸';
        if (lower.includes('Ğ³Ğ¾Ñ€') || lower.includes('mountain') || lower.includes('Ğ°Ğ»ÑŒĞ¿')) return 'ğŸ”ï¸';
        if (lower.includes('Ğ¿Ğ°Ñ€Ğ¸Ğ¶') || lower.includes('paris')) return 'ğŸ—¼';
        if (lower.includes('Ñ€Ğ¸Ğ¼') || lower.includes('rome') || lower.includes('Ğ¸Ñ‚Ğ°Ğ»')) return 'ğŸ›ï¸';
        if (lower.includes('Ğ»Ğ¾Ğ½Ğ´Ğ¾Ğ½') || lower.includes('london')) return 'ğŸ¡';
        if (lower.includes('Ğ½ÑŒÑ-Ğ¹Ğ¾Ñ€Ğº') || lower.includes('new york')) return 'ğŸ—½';
        if (lower.includes('Ñ‚Ğ¾ĞºĞ¸Ğ¾') || lower.includes('tokyo') || lower.includes('ÑĞ¿Ğ¾Ğ½')) return 'ğŸ—¾';
        if (lower.includes('Ğ±Ğ°Ñ€ÑĞµĞ»Ğ¾Ğ½') || lower.includes('Ğ¸ÑĞ¿Ğ°Ğ½')) return 'ğŸ‡ªğŸ‡¸';
        if (lower.includes('ÑÑ‚Ğ°Ğ¼Ğ±ÑƒĞ»') || lower.includes('Ñ‚ÑƒÑ€Ñ†')) return 'ğŸ•Œ';
        if (lower.includes('Ğ´ÑƒĞ±Ğ°Ğ¹') || lower.includes('dubai')) return 'ğŸ™ï¸';
        if (lower.includes('Ñ‚Ğ°Ğ¹Ğ»Ğ°Ğ½Ğ´') || lower.includes('thai') || lower.includes('Ğ±Ğ°Ğ»Ğ¸')) return 'ğŸŒ´';
        if (lower.includes('Ğ³Ñ€ĞµÑ†Ğ¸') || lower.includes('greece') || lower.includes('Ğ°Ñ„Ğ¸Ğ½')) return 'ğŸº';
        if (lower.includes('ĞµĞ³Ğ¸Ğ¿ĞµÑ‚') || lower.includes('egypt')) return 'ğŸª';
        if (lower.includes('Ğ»ĞµÑ') || lower.includes('Ğ¿Ñ€Ğ¸Ñ€Ğ¾Ğ´') || lower.includes('ĞºĞµĞ¼Ğ¿Ğ¸Ğ½Ğ³')) return 'ğŸ•ï¸';
        if (lower.includes('Ğ¾Ğ·ĞµÑ€') || lower.includes('lake')) return 'ğŸï¸';
        if (lower.includes('ĞºÑ€ÑƒĞ¸Ğ·') || lower.includes('cruise') || lower.includes('ĞºĞ¾Ñ€Ğ°Ğ±Ğ»')) return 'ğŸš¢';
        if (lower.includes('Ğ¿Ğ¾Ñ…Ğ¾Ğ´') || lower.includes('hik')) return 'ğŸ¥¾';
        if (lower.includes('Ğ»Ñ‹Ğ¶') || lower.includes('ski') || lower.includes('ÑĞ½ĞµĞ³')) return 'â›·ï¸';
        if (lower.includes('ÑĞ°Ñ„Ğ°Ñ€Ğ¸') || lower.includes('safari')) return 'ğŸ¦';
        return 'âœˆï¸';
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Ğ”ĞĞ‘ĞĞ’Ğ›Ğ•ĞĞ˜Ğ• ĞŸĞĞ•Ğ—Ğ”ĞšĞ˜
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    showAddTripModal() {
        this.showModal({
            title: 'ĞĞ¾Ğ²Ğ°Ñ Ğ¿Ğ¾ĞµĞ·Ğ´ĞºĞ°',
            body: `
                <div class="cover-picker" id="coverPicker" onclick="App.pickCover()">
                    <span class="cover-picker-icon">ğŸ“·</span>
                    <span class="cover-picker-text">Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¾Ğ±Ğ»Ğ¾Ğ¶ĞºÑƒ</span>
                </div>
                <input type="hidden" id="tripCover">
                
                <div class="form-group">
                    <label class="form-label">ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ</label>
                    <input type="text" class="input" id="tripTitle" placeholder="ĞĞ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: ĞŸĞ°Ñ€Ğ¸Ğ¶ 2025">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Ğ”Ğ°Ñ‚Ğ° Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ°</label>
                    <input type="date" class="input" id="tripStart">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Ğ”Ğ°Ñ‚Ğ° Ğ¾ĞºĞ¾Ğ½Ñ‡Ğ°Ğ½Ğ¸Ñ</label>
                    <input type="date" class="input" id="tripEnd">
                </div>
                
                <div class="form-group">
                    <label class="form-label">ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)</label>
                    <textarea class="input" id="tripDesc" placeholder="ĞšÑ€Ğ°Ñ‚ĞºĞ¾Ğµ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾ĞµĞ·Ğ´ĞºĞ¸..."></textarea>
                </div>
                
                <button class="btn btn-primary" onclick="App.saveTrip()">Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¿Ğ¾ĞµĞ·Ğ´ĞºÑƒ</button>
            `
        });
    }
    
    pickCover() {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = 'image/*';
        input.onchange = async (e) => {
            const file = e.target.files[0];
            if (!file) return;
            
            const base64 = await this.fileToBase64(file);
            document.getElementById('tripCover').value = base64;
            document.getElementById('coverPicker').innerHTML = `
                <img src="${base64}">
                <div class="cover-picker-overlay">
                    <span class="cover-picker-icon">ğŸ“·</span>
                    <span class="cover-picker-text">Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ</span>
                </div>
            `;
        };
        input.click();
    }
    
    async saveTrip() {
        const title = document.getElementById('tripTitle').value.trim();
        const start = document.getElementById('tripStart').value;
        const end = document.getElementById('tripEnd').value;
        const desc = document.getElementById('tripDesc').value.trim();
        const cover = document.getElementById('tripCover').value;
        
        if (!title) {
            this.showToast('Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ', 'error');
            return;
        }
        if (!start || !end) {
            this.showToast('Ğ£ĞºĞ°Ğ¶Ğ¸Ñ‚Ğµ Ğ´Ğ°Ñ‚Ñ‹', 'error');
            return;
        }
        
        const trip = {
            id: this.generateId(),
            title,
            startDate: start,
            endDate: end,
            description: desc,
            cover: cover || null,
            created: new Date().toISOString()
        };
        
        await this.dbSave('trips', trip);
        this.closeModal();
        this.showToast('âœˆï¸ ĞŸĞ¾ĞµĞ·Ğ´ĞºĞ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ°!', 'success');
        this.renderTrips();
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Ğ”Ğ•Ğ¢ĞĞ›Ğ˜ ĞŸĞĞ•Ğ—Ğ”ĞšĞ˜
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    async openTrip(tripId) {
        const trip = await this.dbGet('trips', tripId);
        if (!trip) return;
        
        this.currentView = 'tripDetail';
        this.currentTrip = trip;
        this.currentTab = 'schedule';
        
        this.updateHeader(trip.title, true, {
            text: 'Â·Â·Â·',
            onClick: () => this.showTripMenu()
        });
        
        this.renderTripDetail();
    }
    
    async renderTripDetail() {
        const trip = this.currentTrip;
        
        // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ FAB Ğ¼ĞµĞ½Ñ Ğ² Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¾Ñ‚ Ğ²ĞºĞ»Ğ°Ğ´ĞºĞ¸
        this.updateFabForTab();
        
        // Ğ¢Ğ°Ğ±Ñ‹
        const tabs = `
            <div class="tab-bar">
                <button class="tab-item ${this.currentTab === 'schedule' ? 'active' : ''}" onclick="App.switchTab('schedule')">Ğ Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ</button>
                <button class="tab-item ${this.currentTab === 'links' ? 'active' : ''}" onclick="App.switchTab('links')">Ğ¡ÑÑ‹Ğ»ĞºĞ¸</button>
                <button class="tab-item ${this.currentTab === 'notes' ? 'active' : ''}" onclick="App.switchTab('notes')">Ğ—Ğ°Ğ¼ĞµÑ‚ĞºĞ¸</button>
                <button class="tab-item ${this.currentTab === 'photos' ? 'active' : ''}" onclick="App.switchTab('photos')">Ğ¤Ğ¾Ñ‚Ğ¾</button>
            </div>
        `;
        
        let content = '';
        
        switch (this.currentTab) {
            case 'schedule':
                content = await this.renderScheduleTab();
                break;
            case 'links':
                content = await this.renderLinksTab();
                break;
            case 'notes':
                content = await this.renderNotesTab();
                break;
            case 'photos':
                content = await this.renderPhotosTab();
                break;
        }
        
        this.dom.content.innerHTML = tabs + `<div style="padding: 16px;">${content}</div>`;
    }
    
    switchTab(tab) {
        this.currentTab = tab;
        this.renderTripDetail();
    }
    
    updateFabForTab() {
        const items = [];
        
        switch (this.currentTab) {
            case 'schedule':
                items.push({ label: 'Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ', icon: 'ğŸ“…', action: 'App.showAddEventModal()' });
                break;
            case 'links':
                items.push({ label: 'ĞšĞ°Ñ€Ñ‚Ğ° (Google Maps)', icon: 'ğŸ—ºï¸', action: 'App.showAddLinkModal("map")' });
                items.push({ label: 'Instagram', icon: 'ğŸ“¸', action: 'App.showAddLinkModal("instagram")' });
                items.push({ label: 'Ğ¡Ğ°Ğ¹Ñ‚', icon: 'ğŸŒ', action: 'App.showAddLinkModal("web")' });
                break;
            case 'notes':
                items.push({ label: 'Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ¼ĞµÑ‚ĞºÑƒ', icon: 'ğŸ“', action: 'App.showAddNoteModal()' });
                break;
            case 'photos':
                items.push({ label: 'Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ„Ğ¾Ñ‚Ğ¾', icon: 'ğŸ“·', action: 'App.addPhoto()' });
                break;
        }
        
        items.push({ label: 'Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ¿Ğ¾ĞµĞ·Ğ´ĞºĞ¸', icon: 'ğŸ“¤', action: 'App.exportTrip()' });
        
        this.updateFabMenu(items);
        this.showFab();
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Ğ ĞĞ¡ĞŸĞ˜Ğ¡ĞĞĞ˜Ğ•
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    async renderScheduleTab() {
        const events = await this.dbGetAll('events', 'tripId', this.currentTrip.id);
        
        if (events.length === 0) {
            return `
                <div class="empty-state">
                    <div class="empty-icon">ğŸ“…</div>
                    <div class="empty-title">ĞĞµÑ‚ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹</div>
                    <div class="empty-text">Ğ”Ğ¾Ğ±Ğ°Ğ²ÑŒÑ‚Ğµ Ğ¼ĞµÑ€Ğ¾Ğ¿Ñ€Ğ¸ÑÑ‚Ğ¸Ñ Ğ² Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ</div>
                </div>
            `;
        }
        
        // Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾ Ğ´Ğ°Ñ‚Ğ°Ğ¼
        const grouped = {};
        events.forEach(e => {
            if (!grouped[e.date]) grouped[e.date] = [];
            grouped[e.date].push(e);
        });
        
        // Ğ¡Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ´Ğ°Ñ‚
        const sortedDates = Object.keys(grouped).sort();
        
        let html = '';
        sortedDates.forEach(date => {
            const dayEvents = grouped[date].sort((a, b) => a.time.localeCompare(b.time));
            const dateObj = new Date(date);
            
            html += `
                <div class="day-header">
                    <div class="day-date">
                        <span class="day-date-num">${dateObj.getDate()}</span>
                        <span class="day-date-month">${this.getMonthShort(dateObj.getMonth())}</span>
                    </div>
                    <div>
                        <div class="day-title">${this.getWeekday(dateObj)}</div>
                        <div class="day-weekday">${this.formatDate(date)}</div>
                    </div>
                </div>
                <div class="list">
                    ${dayEvents.map(e => `
                        <div class="event-item" onclick="App.showEventDetail('${e.id}')">
                            <span class="event-time">${e.time}</span>
                            <div class="event-content">
                                <div class="event-title">${e.title}</div>
                                ${e.note ? `<div class="event-note">${e.note}</div>` : ''}
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        });
        
        return html;
    }
    
    showAddEventModal() {
        this.showModal({
            title: 'ĞĞ¾Ğ²Ğ¾Ğµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ',
            body: `
                <div class="form-group">
                    <label class="form-label">Ğ”Ğ°Ñ‚Ğ°</label>
                    <input type="date" class="input" id="eventDate" 
                        min="${this.currentTrip.startDate}" 
                        max="${this.currentTrip.endDate}"
                        value="${this.currentTrip.startDate}">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Ğ’Ñ€ĞµĞ¼Ñ</label>
                    <input type="time" class="input" id="eventTime" value="10:00">
                </div>
                
                <div class="form-group">
                    <label class="form-label">ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ</label>
                    <input type="text" class="input" id="eventTitle" placeholder="ĞĞ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: Ğ—Ğ°Ğ²Ñ‚Ñ€Ğ°Ğº Ğ² Ğ¾Ñ‚ĞµĞ»Ğµ">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Ğ—Ğ°Ğ¼ĞµÑ‚ĞºĞ° (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)</label>
                    <textarea class="input" id="eventNote" placeholder="Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ..."></textarea>
                </div>
                
                <button class="btn btn-primary" onclick="App.saveEvent()">Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ</button>
            `
        });
    }
    
    async saveEvent() {
        const date = document.getElementById('eventDate').value;
        const time = document.getElementById('eventTime').value;
        const title = document.getElementById('eventTitle').value.trim();
        const note = document.getElementById('eventNote').value.trim();
        
        if (!date || !time || !title) {
            this.showToast('Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚Ğµ Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ', 'error');
            return;
        }
        
        const event = {
            id: this.generateId(),
            tripId: this.currentTrip.id,
            date,
            time,
            title,
            note
        };
        
        await this.dbSave('events', event);
        this.closeModal();
        this.showToast('ğŸ“… Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¾', 'success');
        this.renderTripDetail();
    }
    
    async showEventDetail(eventId) {
        const event = await this.dbGet('events', eventId);
        if (!event) return;
        
        this.showModal({
            title: event.title,
            body: `
                <div class="description-block">
                    <p><strong>Ğ”Ğ°Ñ‚Ğ°:</strong> ${this.formatDate(event.date)}</p>
                    <p><strong>Ğ’Ñ€ĞµĞ¼Ñ:</strong> ${event.time}</p>
                    ${event.note ? `<p style="margin-top: 12px">${event.note}</p>` : ''}
                </div>
                
                <button class="btn btn-danger" onclick="App.deleteEvent('${eventId}')">Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ</button>
            `
        });
    }
    
    async deleteEvent(eventId) {
        await this.dbDelete('events', eventId);
        this.closeModal();
        this.showToast('ğŸ—‘ï¸ Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¾', 'success');
        this.renderTripDetail();
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Ğ¡Ğ¡Ğ«Ğ›ĞšĞ˜
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    async renderLinksTab() {
        const links = await this.dbGetAll('links', 'tripId', this.currentTrip.id);
        
        if (links.length === 0) {
            return `
                <div class="empty-state">
                    <div class="empty-icon">ğŸ”—</div>
                    <div class="empty-title">ĞĞµÑ‚ ÑÑÑ‹Ğ»Ğ¾Ğº</div>
                    <div class="empty-text">Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞ¹Ñ‚Ğµ Ğ¿Ğ¾Ğ»ĞµĞ·Ğ½Ñ‹Ğµ ÑÑÑ‹Ğ»ĞºĞ¸: ĞºĞ°Ñ€Ñ‚Ñ‹, Instagram, ÑĞ°Ğ¹Ñ‚Ñ‹</div>
                </div>
            `;
        }
        
        // Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾ Ñ‚Ğ¸Ğ¿Ñƒ
        const maps = links.filter(l => l.type === 'map');
        const instagrams = links.filter(l => l.type === 'instagram');
        const webs = links.filter(l => l.type === 'web');
        
        let html = '';
        
        if (maps.length > 0) {
            html += `<div class="section-subheader">ğŸ—ºï¸ ĞšĞ°Ñ€Ñ‚Ñ‹</div>`;
            html += `<div class="list">${maps.map(l => this.renderLinkItem(l)).join('')}</div>`;
        }
        
        if (instagrams.length > 0) {
            html += `<div class="section-subheader">ğŸ“¸ Instagram</div>`;
            html += `<div class="list">${instagrams.map(l => this.renderLinkItem(l)).join('')}</div>`;
        }
        
        if (webs.length > 0) {
            html += `<div class="section-subheader">ğŸŒ Ğ¡Ğ°Ğ¹Ñ‚Ñ‹</div>`;
            html += `<div class="list">${webs.map(l => this.renderLinkItem(l)).join('')}</div>`;
        }
        
        return html;
    }
    
    renderLinkItem(link) {
        const icons = { map: 'ğŸ—ºï¸', instagram: 'ğŸ“¸', web: 'ğŸŒ' };
        const iconClass = { map: 'map', instagram: 'instagram', web: 'web' };
        
        return `
            <div class="list-item" onclick="App.openLink('${link.id}')">
                <div class="list-item-icon ${iconClass[link.type]}">${icons[link.type]}</div>
                <div class="list-item-content">
                    <div class="list-item-title">${link.title}</div>
                    <div class="list-item-subtitle">${this.getDomain(link.url)}</div>
                </div>
                <span class="list-item-arrow">â€º</span>
            </div>
        `;
    }
    
    showAddLinkModal(type) {
        const titles = { map: 'ĞšĞ°Ñ€Ñ‚Ğ°', instagram: 'Instagram', web: 'Ğ¡Ğ°Ğ¹Ñ‚' };
        const placeholders = {
            map: 'https://maps.google.com/...',
            instagram: 'https://instagram.com/...',
            web: 'https://example.com'
        };
        
        this.showModal({
            title: `Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ: ${titles[type]}`,
            body: `
                <input type="hidden" id="linkType" value="${type}">
                
                <div class="form-group">
                    <label class="form-label">ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ</label>
                    <input type="text" class="input" id="linkTitle" placeholder="ĞĞ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: Ğ ĞµÑÑ‚Ğ¾Ñ€Ğ°Ğ½ Ñƒ Ğ¼Ğ¾Ñ€Ñ">
                </div>
                
                <div class="form-group">
                    <label class="form-label">URL</label>
                    <input type="url" class="input" id="linkUrl" placeholder="${placeholders[type]}">
                </div>
                
                <div class="form-group">
                    <label class="form-label">ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)</label>
                    <textarea class="input" id="linkDesc" placeholder="Ğ—Ğ°Ğ¼ĞµÑ‚ĞºĞ° Ğ¾ ÑÑÑ‹Ğ»ĞºĞµ..."></textarea>
                </div>
                
                <button class="btn btn-primary" onclick="App.saveLink()">Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ</button>
            `
        });
    }
    
    async saveLink() {
        const type = document.getElementById('linkType').value;
        const title = document.getElementById('linkTitle').value.trim();
        const url = document.getElementById('linkUrl').value.trim();
        const desc = document.getElementById('linkDesc').value.trim();
        
        if (!title || !url) {
            this.showToast('Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚Ğµ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ URL', 'error');
            return;
        }
        
        const link = {
            id: this.generateId(),
            tripId: this.currentTrip.id,
            type,
            title,
            url,
            description: desc
        };
        
        await this.dbSave('links', link);
        this.closeModal();
        this.showToast('ğŸ”— Ğ¡ÑÑ‹Ğ»ĞºĞ° ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ°', 'success');
        this.renderTripDetail();
    }
    
    async openLink(linkId) {
        const link = await this.dbGet('links', linkId);
        if (!link) return;
        
        this.showModal({
            title: link.title,
            body: `
                ${link.description ? `<div class="description-block"><p class="description-text">${link.description}</p></div>` : ''}
                
                <a href="${link.url}" target="_blank" class="btn btn-primary mb-16">ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ ÑÑÑ‹Ğ»ĞºÑƒ â†—</a>
                
                <button class="btn btn-danger" onclick="App.deleteLink('${linkId}')">Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ</button>
            `
        });
    }
    
    async deleteLink(linkId) {
        await this.dbDelete('links', linkId);
        this.closeModal();
        this.showToast('ğŸ—‘ï¸ Ğ¡ÑÑ‹Ğ»ĞºĞ° ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ°', 'success');
        this.renderTripDetail();
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Ğ—ĞĞœĞ•Ğ¢ĞšĞ˜
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    async renderNotesTab() {
        const notes = await this.dbGetAll('notes', 'tripId', this.currentTrip.id);
        
        if (notes.length === 0) {
            return `
                <div class="empty-state">
                    <div class="empty-icon">ğŸ“</div>
                    <div class="empty-title">ĞĞµÑ‚ Ğ·Ğ°Ğ¼ĞµÑ‚Ğ¾Ğº</div>
                    <div class="empty-text">Ğ—Ğ°Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°Ğ¹Ñ‚Ğµ Ğ²Ğ°Ğ¶Ğ½ÑƒÑ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ğ¿Ğ¾ĞµĞ·Ğ´ĞºĞµ</div>
                </div>
            `;
        }
        
        return `
            <div class="list">
                ${notes.map(n => `
                    <div class="list-item" onclick="App.showNoteDetail('${n.id}')">
                        <div class="list-item-icon note">ğŸ“</div>
                        <div class="list-item-content">
                            <div class="list-item-title">${n.title}</div>
                            <div class="list-item-subtitle">${this.formatDate(n.created.split('T')[0])}</div>
                        </div>
                        <span class="list-item-arrow">â€º</span>
                    </div>
                `).join('')}
            </div>
        `;
    }
    
    showAddNoteModal() {
        this.showModal({
            title: 'ĞĞ¾Ğ²Ğ°Ñ Ğ·Ğ°Ğ¼ĞµÑ‚ĞºĞ°',
            body: `
                <div class="form-group">
                    <label class="form-label">Ğ—Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº</label>
                    <input type="text" class="input" id="noteTitle" placeholder="ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°Ğ¼ĞµÑ‚ĞºĞ¸">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Ğ¢ĞµĞºÑÑ‚</label>
                    <textarea class="input" id="noteText" rows="6" placeholder="Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ°Ğ½Ğ¸Ğµ..."></textarea>
                </div>
                
                <button class="btn btn-primary" onclick="App.saveNote()">Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ</button>
            `
        });
    }
    
    async saveNote() {
        const title = document.getElementById('noteTitle').value.trim();
        const text = document.getElementById('noteText').value.trim();
        
        if (!title || !text) {
            this.showToast('Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚Ğµ Ğ²ÑĞµ Ğ¿Ğ¾Ğ»Ñ', 'error');
            return;
        }
        
        const note = {
            id: this.generateId(),
            tripId: this.currentTrip.id,
            title,
            text,
            created: new Date().toISOString()
        };
        
        await this.dbSave('notes', note);
        this.closeModal();
        this.showToast('ğŸ“ Ğ—Ğ°Ğ¼ĞµÑ‚ĞºĞ° ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ°', 'success');
        this.renderTripDetail();
    }
    
    async showNoteDetail(noteId) {
        const note = await this.dbGet('notes', noteId);
        if (!note) return;
        
        this.showModal({
            title: note.title,
            body: `
                <div class="description-block">
                    <p class="description-text">${note.text}</p>
                </div>
                
                <p class="text-secondary mb-16" style="font-size: 13px">
                    Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¾: ${this.formatDateTime(note.created)}
                </p>
                
                <button class="btn btn-danger" onclick="App.deleteNote('${noteId}')">Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ¼ĞµÑ‚ĞºÑƒ</button>
            `
        });
    }
    
    async deleteNote(noteId) {
        await this.dbDelete('notes', noteId);
        this.closeModal();
        this.showToast('ğŸ—‘ï¸ Ğ—Ğ°Ğ¼ĞµÑ‚ĞºĞ° ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ°', 'success');
        this.renderTripDetail();
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Ğ¤ĞĞ¢Ğ
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    async renderPhotosTab() {
        const photos = await this.dbGetAll('photos', 'tripId', this.currentTrip.id);
        
        if (photos.length === 0) {
            return `
                <div class="empty-state">
                    <div class="empty-icon">ğŸ“·</div>
                    <div class="empty-title">ĞĞµÑ‚ Ñ„Ğ¾Ñ‚Ğ¾</div>
                    <div class="empty-text">Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞ¹Ñ‚Ğµ Ñ„Ğ¾Ñ‚Ğ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ğ¸ Ğ¸Ğ· Ğ¿ÑƒÑ‚ĞµÑˆĞµÑÑ‚Ğ²Ğ¸Ñ</div>
                </div>
            `;
        }
        
        return `
            <div class="photo-grid">
                ${photos.map(p => `
                    <div class="photo-item" onclick="App.showPhotoDetail('${p.id}')">
                        <img src="${p.data}" alt="">
                    </div>
                `).join('')}
            </div>
        `;
    }
    
    addPhoto() {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = 'image/*';
        input.multiple = true;
        input.onchange = async (e) => {
            const files = Array.from(e.target.files);
            
            for (const file of files) {
                const base64 = await this.fileToBase64(file);
                const photo = {
                    id: this.generateId(),
                    tripId: this.currentTrip.id,
                    data: base64,
                    created: new Date().toISOString()
                };
                await this.dbSave('photos', photo);
            }
            
            this.showToast(`ğŸ“· Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¾ Ñ„Ğ¾Ñ‚Ğ¾: ${files.length}`, 'success');
            this.renderTripDetail();
        };
        input.click();
    }
    
    async showPhotoDetail(photoId) {
        const photo = await this.dbGet('photos', photoId);
        if (!photo) return;
        
        this.showModal({
            title: 'Ğ¤Ğ¾Ñ‚Ğ¾',
            body: `
                <img src="${photo.data}" style="width: 100%; border-radius: 12px; margin-bottom: 16px">
                
                <button class="btn btn-danger" onclick="App.deletePhoto('${photoId}')">Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ñ„Ğ¾Ñ‚Ğ¾</button>
            `
        });
    }
    
    async deletePhoto(photoId) {
        await this.dbDelete('photos', photoId);
        this.closeModal();
        this.showToast('ğŸ—‘ï¸ Ğ¤Ğ¾Ñ‚Ğ¾ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¾', 'success');
        this.renderTripDetail();
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ĞœĞ•ĞĞ® ĞŸĞĞ•Ğ—Ğ”ĞšĞ˜
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    showTripMenu() {
        this.showModal({
            title: 'Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ',
            body: `
                <div class="list">
                    <div class="list-item" onclick="App.editTrip()">
                        <div class="list-item-icon" style="background: #e3f2fd">âœï¸</div>
                        <div class="list-item-content">
                            <div class="list-item-title">Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ</div>
                        </div>
                    </div>
                    <div class="list-item" onclick="App.exportTrip()">
                        <div class="list-item-icon" style="background: #e8f5e9">ğŸ“¤</div>
                        <div class="list-item-content">
                            <div class="list-item-title">Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ² JSON</div>
                            <div class="list-item-subtitle">ĞŸĞ¾Ğ´ĞµĞ»Ğ¸Ñ‚ÑŒÑÑ Ñ ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ°Ğ¼Ğ¸</div>
                        </div>
                    </div>
                    <div class="list-item" onclick="App.deleteTrip()">
                        <div class="list-item-icon" style="background: #ffebee">ğŸ—‘ï¸</div>
                        <div class="list-item-content">
                            <div class="list-item-title" style="color: var(--danger)">Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾ĞµĞ·Ğ´ĞºÑƒ</div>
                        </div>
                    </div>
                </div>
            `
        });
    }
    
    async editTrip() {
        const trip = this.currentTrip;
        
        this.showModal({
            title: 'Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ',
            body: `
                <div class="cover-picker" id="coverPicker" onclick="App.pickCover()">
                    ${trip.cover 
                        ? `<img src="${trip.cover}"><div class="cover-picker-overlay"><span class="cover-picker-icon">ğŸ“·</span><span class="cover-picker-text">Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ</span></div>`
                        : `<span class="cover-picker-icon">ğŸ“·</span><span class="cover-picker-text">Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¾Ğ±Ğ»Ğ¾Ğ¶ĞºÑƒ</span>`
                    }
                </div>
                <input type="hidden" id="tripCover" value="${trip.cover || ''}">
                
                <div class="form-group">
                    <label class="form-label">ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ</label>
                    <input type="text" class="input" id="tripTitle" value="${trip.title}">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Ğ”Ğ°Ñ‚Ğ° Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ°</label>
                    <input type="date" class="input" id="tripStart" value="${trip.startDate}">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Ğ”Ğ°Ñ‚Ğ° Ğ¾ĞºĞ¾Ğ½Ñ‡Ğ°Ğ½Ğ¸Ñ</label>
                    <input type="date" class="input" id="tripEnd" value="${trip.endDate}">
                </div>
                
                <div class="form-group">
                    <label class="form-label">ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ</label>
                    <textarea class="input" id="tripDesc">${trip.description || ''}</textarea>
                </div>
                
                <button class="btn btn-primary" onclick="App.updateTrip()">Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ</button>
            `
        });
    }
    
    async updateTrip() {
        const trip = this.currentTrip;
        
        trip.title = document.getElementById('tripTitle').value.trim();
        trip.startDate = document.getElementById('tripStart').value;
        trip.endDate = document.getElementById('tripEnd').value;
        trip.description = document.getElementById('tripDesc').value.trim();
        trip.cover = document.getElementById('tripCover').value || null;
        
        await this.dbSave('trips', trip);
        this.closeModal();
        this.showToast('âœ… Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¾', 'success');
        this.updateHeader(trip.title, true, { text: 'Â·Â·Â·', onClick: () => this.showTripMenu() });
    }
    
    async deleteTrip() {
        if (!confirm('Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾ĞµĞ·Ğ´ĞºÑƒ Ğ¸ Ğ²ÑĞµ ÑĞ²ÑĞ·Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ?')) return;
        
        const tripId = this.currentTrip.id;
        
        // Ğ£Ğ´Ğ°Ğ»ÑĞµĞ¼ Ğ²ÑĞµ ÑĞ²ÑĞ·Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
        const events = await this.dbGetAll('events', 'tripId', tripId);
        for (const e of events) await this.dbDelete('events', e.id);
        
        const links = await this.dbGetAll('links', 'tripId', tripId);
        for (const l of links) await this.dbDelete('links', l.id);
        
        const notes = await this.dbGetAll('notes', 'tripId', tripId);
        for (const n of notes) await this.dbDelete('notes', n.id);
        
        const photos = await this.dbGetAll('photos', 'tripId', tripId);
        for (const p of photos) await this.dbDelete('photos', p.id);
        
        await this.dbDelete('trips', tripId);
        
        this.closeModal();
        this.showToast('ğŸ—‘ï¸ ĞŸĞ¾ĞµĞ·Ğ´ĞºĞ° ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ°', 'success');
        this.renderTrips();
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Ğ­ĞšĞ¡ĞŸĞĞ Ğ¢ / Ğ˜ĞœĞŸĞĞ Ğ¢
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    async exportTrip() {
        const trip = this.currentTrip;
        const tripId = trip.id;
        
        const data = {
            version: '1.0',
            exportDate: new Date().toISOString(),
            trip: trip,
            events: await this.dbGetAll('events', 'tripId', tripId),
            links: await this.dbGetAll('links', 'tripId', tripId),
            notes: await this.dbGetAll('notes', 'tripId', tripId),
            photos: await this.dbGetAll('photos', 'tripId', tripId)
        };
        
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        
        const a = document.createElement('a');
        a.href = url;
        a.download = `trip_${trip.title.replace(/\s+/g, '_')}_${new Date().toISOString().split('T')[0]}.json`;
        a.click();
        
        URL.revokeObjectURL(url);
        this.closeModal();
        this.showToast('ğŸ“¤ ĞŸĞ¾ĞµĞ·Ğ´ĞºĞ° ÑĞºÑĞ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ°', 'success');
    }
    
    async exportAllData() {
        const trips = await this.dbGetAll('trips');
        const allData = {
            version: '1.0',
            exportDate: new Date().toISOString(),
            trips: []
        };
        
        for (const trip of trips) {
            allData.trips.push({
                trip: trip,
                events: await this.dbGetAll('events', 'tripId', trip.id),
                links: await this.dbGetAll('links', 'tripId', trip.id),
                notes: await this.dbGetAll('notes', 'tripId', trip.id),
                photos: await this.dbGetAll('photos', 'tripId', trip.id)
            });
        }
        
        const blob = new Blob([JSON.stringify(allData, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        
        const a = document.createElement('a');
        a.href = url;
        a.download = `tripplanner_backup_${new Date().toISOString().split('T')[0]}.json`;
        a.click();
        
        URL.revokeObjectURL(url);
        this.showToast('ğŸ“¤ Ğ’ÑĞµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ ÑĞºÑĞ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹', 'success');
    }
    
    importData() {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = '.json';
        input.onchange = async (e) => {
            const file = e.target.files[0];
            if (!file) return;
            
            try {
                const text = await file.text();
                const data = JSON.parse(text);
                
                if (data.trips) {
                    // ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ±ÑĞºĞ°Ğ¿
                    for (const item of data.trips) {
                        await this.importTripData(item);
                    }
                } else if (data.trip) {
                    // ĞĞ´Ğ½Ğ° Ğ¿Ğ¾ĞµĞ·Ğ´ĞºĞ°
                    await this.importTripData(data);
                }
                
                this.showToast('ğŸ“¥ Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹', 'success');
                this.renderTrips();
            } catch (error) {
                console.error(error);
                this.showToast('âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ°', 'error');
            }
        };
        input.click();
    }
    
    async importTripData(data) {
        // Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµĞ¼ Ğ½Ğ¾Ğ²Ñ‹Ğµ ID Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¸Ğ·Ğ±ĞµĞ¶Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚Ğ¾Ğ²
        const oldTripId = data.trip.id;
        const newTripId = this.generateId();
        
        data.trip.id = newTripId;
        await this.dbSave('trips', data.trip);
        
        for (const event of (data.events || [])) {
            event.id = this.generateId();
            event.tripId = newTripId;
            await this.dbSave('events', event);
        }
        
        for (const link of (data.links || [])) {
            link.id = this.generateId();
            link.tripId = newTripId;
            await this.dbSave('links', link);
        }
        
        for (const note of (data.notes || [])) {
            note.id = this.generateId();
            note.tripId = newTripId;
            await this.dbSave('notes', note);
        }
        
        for (const photo of (data.photos || [])) {
            photo.id = this.generateId();
            photo.tripId = newTripId;
            await this.dbSave('photos', photo);
        }
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // UI ĞšĞĞœĞŸĞĞĞ•ĞĞ¢Ğ«
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    showModal(content) {
        this.dom.modalContent.innerHTML = `
            <div class="modal-handle"></div>
            <div class="modal-header">
                <span class="modal-title">${content.title || ''}</span>
                <button class="modal-close" onclick="App.closeModal()">Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾</button>
            </div>
            <div class="modal-body">${content.body || ''}</div>
        `;
        this.dom.modal.classList.add('active');
    }
    
    closeModal() {
        this.dom.modal.classList.remove('active');
    }
    
    showToast(message, type = 'info') {
        this.dom.toast.textContent = message;
        this.dom.toast.className = `toast ${type} show`;
        setTimeout(() => this.dom.toast.classList.remove('show'), 3000);
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Ğ£Ğ¢Ğ˜Ğ›Ğ˜Ğ¢Ğ«
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    generateId() {
        return Date.now().toString(36) + Math.random().toString(36).substr(2);
    }
    
    formatDate(dateStr) {
        const date = new Date(dateStr);
        return date.toLocaleDateString('ru-RU', { day: 'numeric', month: 'long', year: 'numeric' });
    }
    
    formatDateTime(isoStr) {
        const date = new Date(isoStr);
        return date.toLocaleDateString('ru-RU', { 
            day: 'numeric', month: 'long', year: 'numeric',
            hour: '2-digit', minute: '2-digit'
        });
    }
    
    formatDateRange(start, end) {
        const s = new Date(start);
        const e = new Date(end);
        
        const sMonth = s.toLocaleDateString('ru-RU', { month: 'short' });
        const eMonth = e.toLocaleDateString('ru-RU', { month: 'short' });
        
        if (s.getMonth() === e.getMonth() && s.getFullYear() === e.getFullYear()) {
            return `${s.getDate()} â€“ ${e.getDate()} ${sMonth} ${s.getFullYear()}`;
        }
        
        return `${s.getDate()} ${sMonth} â€“ ${e.getDate()} ${eMonth} ${s.getFullYear()}`;
    }
    
    getMonthShort(month) {
        const months = ['ÑĞ½Ğ²', 'Ñ„ĞµĞ²', 'Ğ¼Ğ°Ñ€', 'Ğ°Ğ¿Ñ€', 'Ğ¼Ğ°Ğ¹', 'Ğ¸ÑĞ½', 'Ğ¸ÑĞ»', 'Ğ°Ğ²Ğ³', 'ÑĞµĞ½', 'Ğ¾ĞºÑ‚', 'Ğ½Ğ¾Ñ', 'Ğ´ĞµĞº'];
        return months[month];
    }
    
    getWeekday(date) {
        const days = ['Ğ’Ğ¾ÑĞºÑ€ĞµÑĞµĞ½ÑŒĞµ', 'ĞŸĞ¾Ğ½ĞµĞ´ĞµĞ»ÑŒĞ½Ğ¸Ğº', 'Ğ’Ñ‚Ğ¾Ñ€Ğ½Ğ¸Ğº', 'Ğ¡Ñ€ĞµĞ´Ğ°', 'Ğ§ĞµÑ‚Ğ²ĞµÑ€Ğ³', 'ĞŸÑÑ‚Ğ½Ğ¸Ñ†Ğ°', 'Ğ¡ÑƒĞ±Ğ±Ğ¾Ñ‚Ğ°'];
        return days[date.getDay()];
    }
    
    getDomain(url) {
        try {
            return new URL(url).hostname;
        } catch {
            return url;
        }
    }
    
    async fileToBase64(file) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = () => resolve(reader.result);
            reader.onerror = reject;
            reader.readAsDataURL(file);
        });
    }
    
    registerServiceWorker() {
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./sw.js')
                .then(() => console.log('âœ… Service Worker Ğ·Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½'))
                .catch(err => console.log('Service Worker Ğ¾ÑˆĞ¸Ğ±ĞºĞ°:', err));
        }
    }
}

// Ğ—Ğ°Ğ¿ÑƒÑĞº
const App = new TripPlannerApp();
document.addEventListener('DOMContentLoaded', () => App.init());
window.App = App;
</script>
</body>
</html>
